<!DOCTYPE html>
<html>
<head>
  <title>Online Result</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #999; padding: 8px; text-align: left; }
    th { background-color: #f0f0f0; }
    .summary { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Result Checker</h2>
  <input type="text" id="symbolInput" placeholder="Enter Symbol Number">
  <button onclick="fetchResult()">Get Result</button>

  <div id="result"></div>

  <script>
    const apiUrl = "https://script.google.com/macros/s/AKfycbzMzVQR7eFrWNB-LRxG7O6Br9Npxh450hrOwt8eJcEMSMgrI7kycmdd1r12zARSXAxBaw/exec";
    function fetchResult() {
      const symbol = document.getElementById("symbolInput").value.trim();
      if (!symbol) {
        alert("Please enter symbol number.");
        return;
      }

      fetch(`${apiUrl}?symbol=${symbol}`)
        .then(res => res.json())
        .then(data => {
          if (!data || !data.Name) {
            document.getElementById("result").innerHTML = "<p style='color:red;'>Result not found!</p>";
            return;
          }

          let html = `
            <h3>Student Information</h3>
            <p><strong>Registration:</strong> ${data.Registration}</p>
            <p><strong>Name:</strong> ${data.Name}</p>
            <p><strong>Gender:</strong> ${data.Gender}</p>
            <p><strong>DOB:</strong> ${data.DOB}</p>
            <p><strong>Symbol No:</strong> ${data.Symbol}</p>

            <h3>Gradesheet</h3>
            <table>
              <tr>
                <th>Subject Code</th>
                <th>Subject</th>
                <th>Grade</th>
                <th>Grade Point</th>
              </tr>`;

          data.Subjects.forEach(sub => {
            html += `
              <tr>
                <td>${sub.code1}<br>${sub.code2}</td>
                <td>${sub.name1}<br>${sub.name2}</td>
                <td>${sub.grade1}<br>${sub.grade2}</td>
                <td>${sub.gp1}<br>${sub.gp2}</td>
              </tr>`;
          });

          html += `</table>
            <p class="summary">GPA: ${data.GPA}</p>
            <p class="summary">Result: ${data.Result}</p>`;

          document.getElementById("result").innerHTML = html;
        })
        .catch(err => {
          console.error(err);
          document.getElementById("result").innerHTML = "<p style='color:red;'>Error fetching result.</p>";
        });
    }
  </script>
</body>
</html>
