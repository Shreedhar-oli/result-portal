<!DOCTYPE html>
<html>
<head>
  <title>Guru Jajur Secondary School Result</title>
  <style>
    body { font-family: Arial; padding: 30px; background: #f2f2f2; }
    .card {
      background: white; padding: 20px; border-radius: 10px;
      max-width: 800px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2, h3 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    .info { margin-top: 20px; }
    .info span { display: block; margin-bottom: 5px; }
  </style>
</head>
<body>
<div class="card">
  <h2>Guru Jajur Secondary School</h2>
  <h3>Grade XI - Annual Examination Result 2082</h3>

  <div class="input">
    <label>Enter Roll Number:</label>
    <input type="text" id="rollInput" />
    <button onclick="fetchResult()">Get Result</button>
  </div>

  <div id="result" style="display:none;">
    <div class="info">
      <span><strong>Name:</strong> <span id="name"></span></span>
      <span><strong>Gender:</strong> <span id="gender"></span></span>
      <span><strong>DOB:</strong> <span id="dob"></span></span>
      <span><strong>Roll No:</strong> <span id="roll"></span></span>
    </div>

    <table>
      <thead>
        <tr><th>Subject</th><th>Grade</th><th>Grade Point</th></tr>
      </thead>
      <tbody id="subjects"></tbody>
    </table>

    <div class="info">
      <span><strong>Final Grade:</strong> <span id="grade"></span></span>
      <span><strong>GPA:</strong> <span id="gpa"></span></span>
      <span><strong>Result:</strong> <span id="status"></span></span>
    </div>
  </div>
</div>

<script>
  const apiUrl = "https://script.google.com/macros/s/AKfycbzb0B7SaRSAJiKzUoU6hI7RMB4LzO6Uoua1fn3qCWuuNj4faKMKahn_IJGeajWt_DqJkA/exec";

  function fetchResult() {
    const roll = document.getElementById("rollInput").value;
    fetch(`${apiUrl}?symbol=${roll}`)
      .then(res => res.json())
      .then(data => {
        if (!data.Name) return alert("Result not found!");

        document.getElementById("result").style.display = "block";
        document.getElementById("name").innerText = data.Name;
        document.getElementById("gender").innerText = data.Gender;
        document.getElementById("dob").innerText = data.DOB;
        document.getElementById("roll").innerText = data.Roll;
        document.getElementById("grade").innerText = data.Grade;
        document.getElementById("gpa").innerText = data.GPA;
        document.getElementById("status").innerText = data.Result;

        let tbody = document.getElementById("subjects");
        tbody.innerHTML = "";
        data.Subjects.forEach(sub => {
          tbody.innerHTML += `<tr><td>${sub.name}</td><td>${sub.grade}</td><td>${sub.gp}</td></tr>`;
        });
      })
      .catch(err => {
        alert("Error fetching result.");
        console.error(err);
      });
  }
</script>
</body>
</html>
